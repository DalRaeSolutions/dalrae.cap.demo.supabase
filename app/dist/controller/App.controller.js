sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel"],function(t,e){"use strict";return t.extend("dalrae.cap.supabase.fioridemo.controller.App",{comps:{},onInit:function(){this.getView().addStyleClass(this.getOwnerComponent().getContentDensityClass());this.getView().setModel(new e({loggedIn:false,url:"",notificationsNumber:0,notifications:[]}));this.cookie(client.auth.session()||{});client.auth.onAuthStateChange((t,e)=>{this.cookie(e||{})});client.from("*").on("*",t=>{const e=this.getView().getModel();const o=e.getProperty("/notifications");o.push(t);e.setProperty("/notifications",o);e.setProperty("/notificationsNumber",o.length)}).subscribe()},onBeforeRendering:async function(){const{loggedIn:t,user:e}=await $.getJSON("/auth/me");this.getView().getModel().setProperty("/loggedIn",t);this.getView().getModel().setProperty("/url",`https://avatars.dicebear.com/api/human/${e.id||Math.random().toString(16).slice(2)}.svg`)},menu:function(){this.getView().byId("menu").openBy(this.getView().byId("avatar"))},onNavButtonPressed:function(){window.history.back()},onNotificationsPressed:function(){this.byId("notifications")},onItemClose:function(t){var e=t.getSource(),o=e.getParent();o.removeItem(e);MessageToast.show("Item Closed: "+e.getTitle())},logout:function(){window.client.auth.signOut()},github:function(){window.open("https://github.com/DalRaeSolutions/dalrae.cap.demo.supabase","_blank")},cookie:function(t){fetch("/auth/cookie",{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json; charset=UTF-8"}}).then(t=>t.json()).then(()=>{this.onBeforeRendering()}).catch(t=>console.log(t))}})});