sap.ui.define(["dalrae/cap/supabase/fioridemo/Supabase","sap/ui/model/json/JSONModel"],function(e,t){"use strict";return e.extend("dalrae.cap.supabase.fioridemo.controller.App",{comps:{},onInit:function(){e.prototype.onInit.apply(this,arguments);this.getView().setModel(new t({loggedIn:false,url:"",notificationsNumber:0,notifications:[]}))},onBeforeRendering:async function(){this._switch()},_switch:async function(){const e=await(await fetch("/auth/me")).json();const t=this.getView().byId("container");this.getView().getModel().setProperty("/loggedIn",!!e?.email);if(e?.email){this.getView().getModel().setProperty("/url",`https://avatars.dicebear.com/api/croodles-neutral/${e?.email}.svg`);sap.ui.getCore().setModel(this.getView().getModel(),"user");this._getComponent("chatComponent").then(e=>t.setComponent(e))}else{this._getComponent("loginComponent").then(e=>t.setComponent(e))}},_getComponent:function(e){return new Promise((t,n)=>{this.getOwnerComponent().createComponent({usage:e,async:true}).then(e=>t(e)).catch(e=>n(e))})},menu:function(){this.getView().byId("menu").openBy(this.getView().byId("avatar"))},onNavButtonPressed:function(){window.history.back()},onNotificationsPressed:function(){this.byId("notifications")},onItemClose:function(e){var t=e.getSource(),n=t.getParent();n.removeItem(t);MessageToast.show("Item Closed: "+t.getTitle())}})});