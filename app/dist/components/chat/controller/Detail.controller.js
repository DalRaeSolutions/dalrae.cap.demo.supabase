sap.ui.define(["dalrae/cap/supabase/fioridemo/Supabase"],function(e){"use strict";return e.extend("dalrae.cap.supabase.fioridemo.components.chat.controller.Master",{onInit:function(){const e=this.getView().byId("exitFullScreenBtn");const t=this.getView().byId("enterFullScreenBtn");this.oRouter=this.getOwnerComponent().getRouter();this.oModel=this.getOwnerComponent().getModel("layout");this.bus=sap.ui.getCore().getEventBus();this.list=this.getView().byId("chatlist");this.getView().setModel(sap.ui.getCore().getModel("user"),"user");this.oRouter.getRoute("detail").attachPatternMatched(this._onChannelMatched,this);[e,t].forEach(function(e){e.addEventDelegate({onAfterRendering:function(){if(this.bFocusFullScreenButton){this.bFocusFullScreenButton=false;e.focus()}}.bind(this)})},this);this.bus.subscribe("chat","insert:message",()=>this.list.getModel().refresh())},refreshList:function(){console.log("refreshing list").getModel().refresh()},handleFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/fullScreen");this.oRouter.navTo("detail",{layout:e,channel:this._channel})},handleExitFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/exitFullScreen");this.oRouter.navTo("detail",{layout:e,channel:this._channel})},handleClose:function(){var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/closeColumn");this.oRouter.navTo("master",{layout:e})},onPost:async function(){const e=this.getView().getBindingContext().getObject().ID;const t=arguments[0].getParameter("value");await fetch("/chat/createMessage",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({channel_ID:e,message:t})})},_onChannelMatched:function(e){this._channel=e.getParameter("arguments").channel||this._channel||"0";this.getView().bindElement({path:`/${this._channel}`})}})});